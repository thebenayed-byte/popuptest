<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Push Test</title>
</head>
<body style="font-family:sans-serif;text-align:center;margin-top:100px;">

<h2>Notifications Réelles Firebase</h2>
<button onclick="init()">Activer les notifications</button>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getMessaging, getToken } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-messaging.js";

const firebaseConfig = {
  apiKey: "AIzaSyDwIGeziyq7cQQqQp8PuAVPw6c9J8-9o1g",
  authDomain: "popup-bfbde.firebaseapp.com",
  projectId: "popup-bfbde",
  storageBucket: "popup-bfbde.firebasestorage.app",
  messagingSenderId: "402296852000",
  appId: "1:402296852000:web:09fcc8966b238288a5f645",
  measurementId: "G-NYVPD0QYYD"
};

const app = initializeApp(firebaseConfig);
const messaging = getMessaging(app);

window.init = async function() {

  const permission = await Notification.requestPermission();
  if (permission !== "granted") {
    alert("Permission refusée");
    return;
  }

  const registration = await navigator.serviceWorker.register("./firebase-messaging-sw.js");

  const token = await getToken(messaging, {
    vapidKey: "3P8-pewWV_6f304jt8Ome7UhytM0r8PtH63_9q4FAl0",
    serviceWorkerRegistration: registration
  });

  alert("TOKEN UTILISATEUR :\n\n" + token);
  console.log("TOKEN :", token);
};

</script>

</body>
</html>
